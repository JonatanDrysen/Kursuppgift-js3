import React, { useState } from 'react';
import PrimaryButton from './styled/PrimaryButton';
import SecondaryButton from './styled/SecondaryButton';

export default function CustomerCreate(props) {
    const [name, setName] = useState('')
    const [email, setEmail] = useState('')
    const [phoneNumber, setPhoneNumber] = useState('')
    const [orgNr, setOrgNr] = useState('')
    const [vatNr, setVatNr] = useState('')
    const [reference, setReference] = useState('')
    const [paymentTerm, setPaymentTerm] = useState('')
    const [website, setWebsite] = useState('')

    function handleFormOnSubmit(e) {
        e.preventDefault()
        const url = 'https://frebi.willandskill.eu/api/v1/customers/'
        const token = localStorage.getItem('webb21-kursuppgift-js3')
        const payload = {
            name, 
            email,
            phoneNumber,
            orgNr,
            vatNr,
            reference,
            paymentTerm,
            website
        }
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(payload)
        })
        .then(res => res.json())
        .then(data => props.onSuccess())
    }

    function renderInput(type, placeholder, value, setValue) {
        return (
            <input
                type={type}
                placeholder={placeholder}
                value={value}
                onChange={e => setValue(e.target.value)}
            />
        )
    }

    return (
        <div>
            <form onSubmit={handleFormOnSubmit}>
                {renderInput('text', 'Company name', name, setName)}
                {renderInput('text', 'E-Mail', email, setEmail)}
                {renderInput('tel', 'Phone number', phoneNumber, setPhoneNumber)}
                {renderInput('text', 'Organisation number', orgNr, setOrgNr)}
                {renderInput('text', 'VAT number', vatNr, setVatNr)}
                {renderInput('text', 'Reference', reference, setReference)}
                {renderInput('text', 'Payment term', paymentTerm, setPaymentTerm)}
                {renderInput('url', 'Website (.com)', website, setWebsite)}
                <PrimaryButton type='submit'>Register new client</PrimaryButton>
            </form>
        </div>
    )
}
